@inject IMasterHelper masterHelper

@model PaginationList<TDailyTask>

@{
	ViewData["Title"] = "Daily Task";
}

<table style="width:100%">
	<tr class="d-flex justify-content-between align-items-center">
		<td class="d-flex align-items-center">
			<h4>Daily Task List</h4>	
			<span style="margin-left:10px">(Total: @Model.TotalItem items)</span>
			<a href="@Url.Action("Create", "TDailyTask")" class="btn btn-success" style="margin-left:25px">ADD</a>
		</td>
		<td class="ms-auto">
			@await Html.PartialAsync("SearchBar", @ViewData["SearchFilter"])
		</td>
	</tr>
</table>

<table class="table">
	<thead>	
		<tr>
			<th></th>
			<th>
				<a asp-controller="TDailyTask" asp-action="Index" asp-route-index="@Model.PageIndex" asp-route-sortOrder="@ViewData["SortParamReportID"]" asp-route-searchFilter="@ViewData["SearchFilter"]">
					Report ID
					@if (@ViewData["SortOrder"]?.ToString() == "asc")
					{
						<i class="bi bi-arrow-up"></i>
					}
					else if (@ViewData["SortOrder"]?.ToString() == "desc")
					{
						<i class="bi bi-arrow-down"></i>
					}
				</a>
			</th>
			<th>Reported On</th>
			<th>Scheduled On</th>
			<th>Title</th>
			<th>Status</th>
			<th>PIC</th>
			<th>Type</th>
			<th>Completed On</th>
			@* <th>Created By</th>
			<th>Created On</th>
			<th>Updated By</th>
			<th>Updated On</th> *@
		</tr>		
	</thead>
	<tbody>
		@foreach (var item in Model)
		{
			var rowclass = item.StatusID switch
			{
				FixedStatus.WIP_UID => "table-secondary",
				FixedStatus.HOLD_UID => "table-danger",
				FixedStatus.COMPLETED_UID => "table-success",
				_ => ""
			};

			<tr class="@rowclass">
				<td>
					<a href="@Url.Action("Edit", "TDailyTask", new { id = item.UID })" class="btn btn-outline-danger">
						<i class="bi bi-pencil text-warning"></i>
					</a>
					<a href="@Url.Action("Delete", "TDailyTask", new { id = item.UID })" class="btn btn-outline-warning">
						<i class="bi bi-trash text-danger"></i>
					</a>
				</td>
				<td>@item.ReportByID</td>
				<td>@item.ReportedOn</td>
				<td>@item.ScheduledOn</td>
				<td>@item.Title</td>
				<td>@(masterHelper.GetStatusByID(item.StatusID.Value)?.Result?.Name)</td>
				<td>@(masterHelper.GetAccountInfoByID(item.PICID.Value)?.Result?.Name)</td>
				<td>@(masterHelper.GetTypeByID(item.TypeID.Value)?.Result?.Name)</td>				
				<td>@item.CompletedOn</td>
				@* <td>@item.CreatedBy</td>
				<td>@item.CreatedOn</td>
				<td>@item.UpdatedBy</td>
				<td>@item.UpdatedOn</td> *@
			</tr>
		}
	</tbody>
</table>

@await Html.PartialAsync("PageBar", ("TDailyTask", Model.PageIndex, Model.TotalPage))